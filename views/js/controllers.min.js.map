{"version":3,"file":"routes.js","sources":["routes.js","migrate.js"],"names":[],"mappings":"AAqBA,OAAA,uCAAA,WAGA,OACA,iBAEA,SACA,QAAA,0BCRA,OAAA,sCAAA,SAAA,SAAA,OAAA,UAAA,WACA,SAAA,OAAA,EAAA,GAAA,SAEA,GAAA,gBACA,MAAA,WACA,EAAA,aAAA,MAEA,WAGA,GAAA,WAAA,EAAA,MAAA,KAAA,MACA,UACA,UAGA,UAAA,QAAA,SAAA,iCACA,eAAA,QAAA,SAAA,6CAGA,GAAA,cAAA,QACA,EAAA,cAAA,QACA,EAAA,iBAAA,QAIA,EAAA,2BAAA,KAAA,WACA,OAAA,KAAA,EAAA,MAAA,OAKA,MAAA,EAAA,MAAA,SAAA,MAGA;EAAA,UAAA,KAAA,OAAA,SAAA,gBAGA,EAAA,2BAAA,KAAA,WACA,OAAA,KAAA,EAAA,MAAA,OAEA,MAAA,EAAA,MAAA,SAAA,MAGA,GAAA,UAAA,KAAA,OAAA,SAAA,gBAGA,EAAA,UAAA,UAAA,YAAA,SAAA,iBAEA,EAAA,sBAAA,KAAA,QAAA,uBACA,EAAA,sBAAA,QACA,OAAA,EACA,MAAA,IACA,OAAA,IACA,UAEA,KAAA,GAAA,UAEA,MAAA,WACA,EAAA,MAAA,OAAA,YAIA,KAAA,GAAA,WACA,MAAA,WACA,EAAA,uBAAA,QACA,EAAA,aAAA,UAAA,QAAA,SAAA,sBAGA,EAAA,MACA,IAAA,eACA,KAAA,OACA,MACA,OAAA,OACA,OAAA,OACA,UAAA,WAEA,QAAA,SAAA,MACA,EAAA,uBAAA,QACA,EAAA,UAAA,KAAA,WAAA,SAAA,sBAEA,EAAA,aAAA,KAAA,QAAA,uBACA,EAAA,sBAAA,OAAA;YAgBA,OAAA","sourcesContent":["/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n * \n * \n */\n\n//@see http://forge.taotesting.com/projects/tao/wiki/Front_js\ndefine('taoResultServer/controller/routes',[],function(){\n    'use strict';\n\n    return {\n        'ResultServerMgt': {\n           // 'deps' : 'controller/migrate'\n            'actions': {\n                'migrate' : 'controller/migrate'\n            }\n            \n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2013 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n *\n */\n\ndefine('taoResultServer/controller/migrate',['module', 'jquery','i18n', 'context', 'helpers'], \n        function(module, $, __, context, helpers){\n    \n        var migrateRunner = {\n            start : function(options){\n               $('.opButton').click(\n                       \n                            function(e) {\n                                \n                                \n                                var operation = $(this).attr(\"id\");\n                                var source = []; \n                                var target = [];\n                                \n                                //todo move\n                                var loaderPic = context.root_url+'/tao/views/img/ajax-loader.gif';\n                                var migrateDataUrl = context.root_url+'taoResultServer/ResultServerMgt/migrateData';\n\n                                //clean any former feedback built in the dom\n                                $(\"#selSource\").empty();\n                                $(\"#selTarget\").empty();\n                                $(\"#selOperation\").empty();\n                                \n                               \n                                \n                                $('#sourceStorage :checked').each(function() {\n                                    source.push($(this).val());\n                                    \n                                    //prepare html for confirmation\n                                    //check\n                                    \n                                    label = $(this).parent().text();\n                                    \n                                    //label = $(\"label[for='\"+$(this).attr('id')+\"']\").text();\n                                    var li = $('<li />').html(label).appendTo(\"#selSource\");\n                                     \n                                  });\n                                $('#targetStorage :checked').each(function() {\n                                    target.push($(this).val());\n                                    \n                                    label = $(this).parent().text();\n                                    //prepare html for confirmation\n                                    //label = $(\"label[for='\"+$(this).attr('id')+\"']\").text();\n                                    var li = $('<li />').text(label).appendTo(\"#selTarget\");\n                                  });\n                                  \n                                $('<label>'+operation+'</label>').appendTo(\"#selOperation\");  \n\n                                $(\"#migrationProgress\").attr(\"style\", \"visibility: visible\")\n                                $('#migrationProgress').dialog({\n                                        modal: true,\n                                        width: 500,\n                                        height: 430,\n                                        buttons: [\n                                                {\n                                                        text: __('Cancel'),\n                                                        \n                                                        click: function() {\n                                                                $(this).dialog('close');\n                                                        }\n                                                },\n                                                {\n                                                        text: __('Migrate'),\n                                                        click: function() {\n                                                            $(\" #migrationProgress\").empty();\n                                                            $('<img src=\"'+loaderPic+'\" />').appendTo(\"#migrationProgress\");\n                                                         \n                                                            \n                                                            $.ajax({\n                                                              url: migrateDataUrl,\n                                                              type: 'POST',\n                                                              data: {   \n                                                                   source: source,\n                                                                   target: target,\n                                                                   operation: operation\n                                                               },\n                                                              success: function(data){\n                                                                  $(\" #migrationProgress\").empty();\n                                                                  $('<label>'+data+'<label>').appendTo(\"#migrationProgress\");\n                                                                  \n                                                                  $('#feedback').attr(\"style\", \"visibility: visible\")\n                                                                  $('#migrationProgress').dialog('close');\n                                                              }\n                                                            });\n                                                            \n                                                            \n                                                        }\n                                                }\n                                        ],\n\n                                });\n                            }\n               );\n\n         }\n       };\n   \n        return migrateRunner;\n});\n"]}